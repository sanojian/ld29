<!DOCTYPE html>
<html>
    <head>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
		<title>Control The Map</title>
		
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script type="text/javascript" src="./includes/crafty.js"></script>

		<style>
			body, html { margin:0; padding: 0; overflow:hidden; font-family:Arial; font-size:20px; background: #444444; }
			#cr-stage { border:2px solid black; margin:5px auto; color:white; }

		</style>
		
		<script language="javascript">
"use strict";

var RENDERING_MODE = 'DOM';//'Canvas';
var GAME_FONT = '"Press Start 2P", cursive';
var VIEW_WIDTH = 640;
var VIEW_HEIGHT = 480;
var TILE_WIDTH = 8;

window.addEventListener("load", function(event) {

	//VIEW_WIDTH = $(document).width();
	//VIEW_HEIGHT = $(document).height();
	Crafty.init(VIEW_WIDTH, VIEW_HEIGHT);
	
	initializeCrafty();

});

function initializeCrafty() {

	Crafty.c('Tile', {
	
		Tile: function(x, y) {
			this.requires('2D, ' + RENDERING_MODE + ', dirt1'))
		
			this.locX = x,
			this.locY = y;

			this.attr({ x: x*this.w, y: y*this.h, z: 10 });
			
			return this;
		}
	});


	Crafty.scene("main", function () {
		Crafty.background("#000");
		
		g_game.tiles = [];
		
		for (var y=0;y<8;y++) {
			g_game.tiles[y] = [];
			for (var x=0;x<14;x++) {
				var tile = Crafty.e('Tile').Tile(x, y);
				g_game.tiles[y][x] = tile;
			}
		}
		
		g_game.player = Crafty.e('Player').Player();
		g_game.player.moveTo(4, 4);
		
		var enemy = Crafty.e('Enemy').Enemy();
		enemy.moveTo(6, 6);
		
		
	});
		
	Crafty.scene("loading", function () {
		Crafty.background("#000");

		Crafty.load(['./images/tiles.png'], function() {

			Crafty.sprite(8, './images/tiles.png', {
				enemy: [0, 0],
				player: [1, 0],
				dirt1: [0, 0],
				dirt2: [1, 0]
			})
			
			Crafty.scene("main");
		});
		

	});
	
	Crafty.scene("loading");

}

		</script>
	</head>
	<body>
	
	</body>
</html>
			